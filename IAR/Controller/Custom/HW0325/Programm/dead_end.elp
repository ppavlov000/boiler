//---------------------------------------------------------------------------------------------------
// Test software 
// 
//---------------------------------------------------------------------------------------------------
// Errors list
//#define  cont_no_error 			0x0000
//#define  cont_bad_thermo_sensor 	                0x0100
//#define  cont_freezing_channel		0x0200
//#define  cont_freezing_external		0x0300
//#define  cont_low_temperature		0x0400
//#define  cont_high_temperature		0x0500
//#define  cont_bad_fan			0x0600
//#define  cont_bad_filter			0x0700
//#define  cont_bad_220			0x0800
//---------------------------------------------------------------------------------------------------
// Interrupt table
goto automat_mode;
goto stop_mode;
goto manual_mode;
goto error_mode;
goto custom_mode;
end;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
custom_mode:
mode=4;
end;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
error_mode:
mode=3;
end;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
manual_mode:
mode=2;
end;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
stop_mode:
//mode=1;
goto automat_mode;
end;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
// Main program for handling any equipment
automat_mode:
mode=0;
beep=100;
pid.channel[0]=1;
pid.t0[0]=200;
pid.p[0]=100;
pid.i[0]=0;
pid.d[0]=150;
pid.ti[0]=60;
pid.pow_min[0]=200;
pid.pow_max[0]=1000;
pid.t3max[0]=74;
pid.power[0]=999;
pid.p3[0]=0;

pid.t0[1]=210;
pid.p[1]=110;
pid.i[1]=1;
pid.d[1]=160;
pid.ti[1]=10;
pid.pow_min[1]=210;
pid.pow_max[1]=1100;
pid.t3max[1]=75;
pid.power[1]=555;
pid.p3[1]=0;

pid.t0[2]=220;
pid.p[2]=120;
pid.i[2]=2;
pid.d[2]=170;
pid.ti[2]=20;
pid.pow_min[2]=220;
pid.pow_max[2]=1200;
pid.t3max[2]=77;
pid.power[2]=666;
pid.p3[2]=0;

pid.t0[3]=230;
pid.p[3]=130;
pid.i[3]=3;
pid.d[3]=180;
pid.ti[3]=30;
pid.pow_min[3]=230;
pid.pow_max[3]=1300;
pid.t3max[3]=78;
pid.power[3]=777;
pid.p3[3]=0;

pid.enable[0]=1;
pid.enable[1]=1;
pid.enable[2]=1;
pid.enable[3]=1;
//error=0x0100;
//error=0x0200;
//error=0x0300;
//error=0x0400;
//error=0x0500;
reg[0]=0x12345678;
reg[1]=0x12345678;
reg[2]=0x12345678;
reg[3]=0x55555555;
reg[4]=1;
reg[5]=10;
reg[6]=reg[4]+reg[5];
reg[7]=reg[5]-reg[4];
reg[8]=reg[4]>0;
reg[9]=reg[4]<=0;
reg[10]=reg[4]==1;
reg[11]=reg[4]==2;


reg[0]=0;
ao[0]=0;
ao[1]=0;
beep=100;
//*****************************************************************************
// Main loop
//*****************************************************************************
main_loop:

do[0]=0;
do[1]=0;
do[2]=0;
do[3]=0;
do[4]=0;
do[5]=0;
do[6]=0;
ao[0]=0;
season=0;

goto main_loop;
//*****************************************************************************
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
// Routines
Delay_ms:
pass_if_false timer[0];
goto Delay_ms;
ret;
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------------
